<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout - Guero's Shop</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>Checkout</h1>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="contact.html">Contact Us</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <form id="checkout-form" onsubmit="handlePurchase(event)">
      <h2>Order Summary</h2>
      <div id="order-details">
        <!-- Order summary will be populated here via JavaScript -->
      </div>
      
      <h2>Shipping Information</h2>
      <label for="name">Full Name:</label>
      <input type="text" id="name" name="name" required />
      
      <label for="email">Email Address:</label>
      <input type="email" id="email" name="email" required />
      
      <label for="phone">Phone Number:</label>
      <input type="tel" id="phone" name="phone" required />
      
      <label for="address">Shipping Address:</label>
      <textarea id="address" name="address" required></textarea>
      
      <h2>Payment Options</h2>
      <p>Please select your payment method:</p>
      <div>
        <input type="radio" id="interac" name="payment" value="interac" checked />
        <label for="interac">Interac Email Transfer</label>
      </div>
      <div>
        <input type="radio" id="btc" name="payment" value="btc" />
        <label for="btc">Bitcoin (BTC) - <span id="btc-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="monero" name="payment" value="monero" />
        <label for="monero">Monero - <span id="monero-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="bnb" name="payment" value="bnb" />
        <label for="bnb">Binance Coin (BNB) - <span id="bnb-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="usdt" name="payment" value="usdt" />
        <label for="usdt">Tether (USDT) - <span id="usdt-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="eth" name="payment" value="eth" />
        <label for="eth">Ethereum (ETH) - <span id="eth-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="doge" name="payment" value="doge" />
        <label for="doge">Dogecoin (DOGE) - <span id="doge-rate"></span></label>
      </div>
      
      <p id="payment-instructions"></p>
      
      <button type="submit">Purchase Now</button>
    </form>
  </main>

  <footer>
    <p>&copy; 2025 Guero's Shop</p>
  </footer>
  
  <script src="js/main.js"></script>
  <script>
    // Function to update order summary with crypto total if a crypto payment method is selected.
    function updateOrderSummary() {
      const order = JSON.parse(localStorage.getItem('order'));
      if (!order) return;
      let cryptoLine = '';
      // If buyer details are set (payment method selected later on checkout)
      if (order.buyer && ['btc', 'monero', 'bnb', 'usdt', 'eth', 'doge'].includes(order.buyer.paymentMethod)) {
        const rateEl = document.getElementById(order.buyer.paymentMethod + '-rate');
        if (rateEl) {
          const rateText = rateEl.innerText; // e.g. "$40000"
          const usdRate = parseFloat(rateText.replace('$',''));
          const dollarTotal = parseFloat(order.total);
          if (usdRate && dollarTotal) {
            const cryptoTotal = (dollarTotal / usdRate).toFixed(6);
            cryptoLine = `<p><strong>Total in ${order.buyer.paymentMethod.toUpperCase()}:</strong> ${cryptoTotal}</p>`;
            // Optionally update order object with crypto total
            order.cryptoTotal = cryptoTotal;
            localStorage.setItem('order', JSON.stringify(order));
          }
        }
      }
      const summaryDiv = document.getElementById('order-details');
      summaryDiv.innerHTML = `
        <p><strong>Product:</strong> ${order.name}</p>
        <p><strong>Price (USD):</strong> $${order.price}</p>
        <p><strong>Quantity:</strong> ${order.quantity}</p>
        <p><strong>Total (USD):</strong> $${order.total}</p>
        ${cryptoLine}
      `;
    }

    // Optionally, update the order summary on page load and when payment method changes.
    updateOrderSummary();
  </script>
</body>
</html>
