<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout - Guero's Shop</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>Checkout</h1>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="contact.html">Contact Us</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <form id="checkout-form" onsubmit="handlePurchase(event)">
      <h2>Order Summary</h2>
      <div id="order-details">
        <!-- Order details will be populated via main.js -->
      </div>
      
      <h2>Shipping Information</h2>
      <label for="name">Full Name:</label>
      <input type="text" id="name" name="name" required />

      <label for="email">Email Address:</label>
      <input type="email" id="email" name="email" required />

      <label for="phone">Phone Number:</label>
      <input type="tel" id="phone" name="phone" required />

      <label for="address">Shipping Address:</label>
      <textarea id="address" name="address" required></textarea>

      <h2>Payment Options</h2>
      <p>Please select your payment method:</p>
      <div>
        <input type="radio" id="interac" name="payment" value="interac" checked />
        <label for="interac">Interac Email Transfer</label>
      </div>
      <div>
        <input type="radio" id="btc" name="payment" value="btc" />
        <label for="btc">Bitcoin (BTC) - <span id="btc-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="monero" name="payment" value="monero" />
        <label for="monero">Monero - <span id="monero-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="bnb" name="payment" value="bnb" />
        <label for="bnb">Binance Coin (BNB) - <span id="bnb-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="usdt" name="payment" value="usdt" />
        <label for="usdt">Tether (USDT) - <span id="usdt-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="eth" name="payment" value="eth" />
        <label for="eth">Ethereum (ETH) - <span id="eth-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="doge" name="payment" value="doge" />
        <label for="doge">Dogecoin (DOGE) - <span id="doge-rate"></span></label>
      </div>
      
      <!-- Crypto Conversion Section -->
      <div id="crypto-conversion" style="display:none; margin-top: 10px;">
        <p>
          Total in Crypto: <strong><span id="crypto-total"></span></strong>
          <span id="crypto-currency"></span>
        </p>
      </div>
      
      <p id="payment-instructions"></p>
      
      <button type="submit">Purchase Now</button>
    </form>
  </main>

  <footer>
    <p>&copy; 2025 Guero's Shop</p>
  </footer>

  <!-- Main JS file -->
  <script src="js/main.js"></script>
  <script>
    // This function updates the crypto conversion display if a crypto payment method is selected.
    function updateCryptoDisplay() {
      const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
      const conversionDiv = document.getElementById('crypto-conversion');
      // Only show conversion if a crypto option is selected
      if (['btc', 'monero', 'bnb', 'usdt', 'eth', 'doge'].includes(paymentMethod)) {
        const rateElement = document.getElementById(paymentMethod + '-rate');
        if (rateElement) {
          // Extract conversion rate (e.g., "$40000")
          const rateText = rateElement.innerText;
          const usdRate = parseFloat(rateText.replace('$', ''));
          // Retrieve order details from localStorage (assumes order.total holds the dollar total)
          const order = JSON.parse(localStorage.getItem('order'));
          if (order && order.total) {
            const dollarTotal = parseFloat(order.total);
            if (usdRate && dollarTotal) {
              const cryptoTotal = (dollarTotal / usdRate).toFixed(6);
              conversionDiv.style.display = 'block';
              document.getElementById('crypto-total').innerText = cryptoTotal;
              document.getElementById('crypto-currency').innerText = paymentMethod.toUpperCase();
              return;
            }
          }
        }
      }
      conversionDiv.style.display = 'none';
    }

    // Attach event listener to all payment radio buttons to update crypto display on change
    document.querySelectorAll('input[name="payment"]').forEach(radio => {
      radio.addEventListener('change', updateCryptoDisplay);
    });

    // Optionally, call updateCryptoDisplay on page load
    updateCryptoDisplay();
  </script>
</body>
</html>
