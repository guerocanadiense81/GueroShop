<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout - Guero's Shop</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>Checkout</h1>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="contact.html">Contact Us</a></li>
      </ul>
    </nav>
  </header>
  
  <main>
    <form id="checkout-form" onsubmit="handlePurchase(event)">
      <h2>Order Summary</h2>
      <div id="order-details">
        <!-- Order summary will be populated here -->
      </div>
      
      <h2>Shipping Information</h2>
      <label for="name">Full Name:</label>
      <input type="text" id="name" name="name" required />
      
      <label for="email">Email Address:</label>
      <input type="email" id="email" name="email" required />
      
      <label for="phone">Phone Number:</label>
      <input type="tel" id="phone" name="phone" required />
      
      <label for="address">Shipping Address:</label>
      <textarea id="address" name="address" required></textarea>
      
      <h2>Payment Options</h2>
      <p>Please select your payment method:</p>
      <div>
        <input type="radio" id="interac" name="payment" value="interac" checked />
        <label for="interac">Interac Email Transfer</label>
      </div>
      <div>
        <input type="radio" id="btc" name="payment" value="btc" />
        <label for="btc">Bitcoin (BTC) - <span id="btc-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="monero" name="payment" value="monero" />
        <label for="monero">Monero - <span id="monero-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="bnb" name="payment" value="bnb" />
        <label for="bnb">Binance Coin (BNB) - <span id="bnb-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="usdt" name="payment" value="usdt" />
        <label for="usdt">Tether (USDT) - <span id="usdt-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="eth" name="payment" value="eth" />
        <label for="eth">Ethereum (ETH) - <span id="eth-rate"></span></label>
      </div>
      <div>
        <input type="radio" id="doge" name="payment" value="doge" />
        <label for="doge">Dogecoin (DOGE) - <span id="doge-rate"></span></label>
      </div>
      
      <p id="payment-instructions"></p>
      
      <button type="submit">Purchase Now</button>
    </form>
  </main>
  
  <footer>
    <p>&copy; 2025 Guero's Shop</p>
  </footer>
  
  <!-- Include the main.js file which handles rate fetching and form processing -->
  <script src="js/main.js"></script>
  
  <!-- Inline script to update the order summary with crypto total -->
  <script>
    // Function to update order summary with crypto total below USD total.
    function updateOrderSummary() {
      const order = JSON.parse(localStorage.getItem('order'));
      if (!order) return;
      
      // Get the currently selected payment method.
      const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
      let cryptoLine = '';
      
      // If a crypto method is selected, calculate the crypto equivalent.
      if (['btc', 'monero', 'bnb', 'usdt', 'eth', 'doge'].includes(paymentMethod)) {
        const rateElement = document.getElementById(paymentMethod + '-rate');
        if (rateElement) {
          const rateText = rateElement.innerText; // e.g., "$40000"
          const usdRate = parseFloat(rateText.replace('$', ''));
          const dollarTotal = parseFloat(order.total);
          if (usdRate && dollarTotal) {
            const cryptoTotal = (dollarTotal / usdRate).toFixed(6);
            cryptoLine = `<p><strong>Total in ${paymentMethod.toUpperCase()}:</strong> ${cryptoTotal}</p>`;
            // Optionally update the order object
            order.cryptoTotal = cryptoTotal;
            localStorage.setItem('order', JSON.stringify(order));
          }
        }
      }
      
      // Display the order details along with the crypto total (if any).
      document.getElementById('order-details').innerHTML = `
        <p><strong>Product:</strong> ${order.name}</p>
        <p><strong>Price (USD):</strong> $${order.price}</p>
        <p><strong>Quantity:</strong> ${order.quantity}</p>
        <p><strong>Total (USD):</strong> $${order.total}</p>
        ${cryptoLine}
      `;
    }
    
    // Call updateOrderSummary on page load.
    updateOrderSummary();
    
    // Update order summary whenever a payment method is changed.
    document.querySelectorAll('input[name="payment"]').forEach(radio => {
      radio.addEventListener('change', updateOrderSummary);
    });
  </script>
</body>
</html>
